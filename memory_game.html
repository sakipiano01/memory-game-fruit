<!DOCTYPE html>
<!--
  ============================================================
  ç¥çµŒè¡°å¼±ã‚²ãƒ¼ãƒ ï¼ˆWEBç‰ˆï¼‰
  HTML + CSS + JavaScript ã ã‘ã§å‹•ãã¾ã™ï¼
  ============================================================
-->
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <!-- ã‚¹ãƒãƒ›ã§ã‚‚ãã‚Œã„ã«è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãŠã¾ã˜ãªã„ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¥çµŒè¡°å¼±ã‚²ãƒ¼ãƒ </title>

  <!-- ========================================================
    CSSï¼ˆã‚·ãƒ¼ã‚¨ã‚¹ã‚¨ã‚¹ï¼‰ï¼šè¦‹ãŸç›®ã‚’æ•´ãˆã‚‹ã¨ã“ã‚
    style ã‚¿ã‚°ã®ä¸­ã«æ›¸ãã¾ã™
  ======================================================== -->
  <style>

    /* â”€â”€ å…¨ä½“ã®ãƒªã‚»ãƒƒãƒˆãƒ»åŸºæœ¬è¨­å®š â”€â”€ */
    * {
      /* ã™ã¹ã¦ã®è¦ç´ ã®ä½™ç™½ã‚’ãƒªã‚»ãƒƒãƒˆ */
      margin: 0;
      padding: 0;
      /* box-sizingï¼šå¹…ã®è¨ˆç®—æ–¹æ³•ã‚’çµ±ä¸€ã™ã‚‹ï¼ˆãŠã¾ã˜ãªã„ï¼‰ */
      box-sizing: border-box;
    }

    body {
      /* èƒŒæ™¯è‰² */
      background-color: #f0f4f8;
      /* ãƒ•ã‚©ãƒ³ãƒˆã®ç¨®é¡ */
      font-family: "Helvetica Neue", Arial, sans-serif;
      /* ç”»é¢ã®ä¸­å¤®ã«å¯„ã›ã‚‹ */
      display: flex;
      justify-content: center; /* æ¨ªæ–¹å‘ï¼šä¸­å¤® */
      align-items: flex-start; /* ç¸¦æ–¹å‘ï¼šä¸Šã‹ã‚‰ */
      min-height: 100vh;       /* ç”»é¢ã®é«˜ã•å…¨ä½“ã‚’ä½¿ã† */
      padding: 20px;
    }

    /* â”€â”€ ã‚²ãƒ¼ãƒ å…¨ä½“ã‚’åŒ…ã‚€ç®± â”€â”€ */
    .game-container {
      background-color: #ffffff;
      border-radius: 16px;       /* è§’ã‚’ä¸¸ãã™ã‚‹ */
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12); /* å½± */
      padding: 30px;
      width: 100%;
      max-width: 520px;          /* æœ€å¤§å¹…ã‚’è¨­å®š */
      text-align: center;        /* æ–‡å­—ã‚’ä¸­å¤®æƒãˆ */
    }

    /* â”€â”€ ã‚¿ã‚¤ãƒˆãƒ« â”€â”€ */
    h1 {
      font-size: 28px;
      color: #2d3748;
      margin-bottom: 8px;
    }

    /* â”€â”€ ã‚¹ã‚³ã‚¢è¡¨ç¤º â”€â”€ */
    #score {
      font-size: 16px;
      color: #718096;
      margin-bottom: 20px;
    }

    /* â”€â”€ ã‚«ãƒ¼ãƒ‰ã‚’ä¸¦ã¹ã‚‹ã‚°ãƒªãƒƒãƒ‰ï¼ˆæ ¼å­çŠ¶ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰â”€â”€ */
    #card-grid {
      /* gridï¼šãƒã‚¹ç›®çŠ¶ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã™ã‚‹æ–¹æ³• */
      display: grid;
      /* 4åˆ—ã«å‡ç­‰ã«åˆ†ã‘ã‚‹ */
      grid-template-columns: repeat(4, 1fr);
      /* ã‚«ãƒ¼ãƒ‰é–“ã®ã™ãé–“ */
      gap: 10px;
      margin-bottom: 24px;
    }

    /* â”€â”€ ã‚«ãƒ¼ãƒ‰1æšåˆ†ã®å¤–å´ã®ç®± â”€â”€ */
    .card {
      /* aspect-ratioï¼šç¸¦æ¨ªæ¯”ã‚’ 1:1ï¼ˆæ­£æ–¹å½¢ï¼‰ã«ã™ã‚‹ */
      aspect-ratio: 1 / 1;
      /* perspectiveï¼š3Då›è»¢ã®å¥¥è¡Œãæ„Ÿã‚’å‡ºã™ãŸã‚ã®è¨­å®š */
      perspective: 600px;
      cursor: pointer; /* ãƒã‚¦ã‚¹ã‚’ä¹—ã›ã‚‹ã¨æ‰‹ã®å½¢ã« */
    }

    /* â”€â”€ ã‚«ãƒ¼ãƒ‰ã®å†…å´ï¼ˆå›è»¢ã™ã‚‹éƒ¨åˆ†ï¼‰â”€â”€ */
    .card-inner {
      width: 100%;
      height: 100%;
      /* transitionï¼šã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®šï¼ˆ0.5ç§’ã‹ã‘ã¦å¤‰åŒ–ï¼‰ */
      transition: transform 0.5s ease;
      /* transform-styleï¼šå­è¦ç´ ã‚‚3Dã§è¡¨ç¤ºã™ã‚‹ */
      transform-style: preserve-3d;
      position: relative;
    }

    /* â”€â”€ ã‚ãã‚‰ã‚ŒãŸã¨ãã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ â”€â”€ */
    /* .flipped ã‚¯ãƒ©ã‚¹ãŒã¤ã„ãŸã‚‰ 180åº¦å›è»¢ã™ã‚‹ */
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    /* â”€â”€ ã‚«ãƒ¼ãƒ‰ã®è¡¨ãƒ»è£å…±é€šã®ã‚¹ã‚¿ã‚¤ãƒ« â”€â”€ */
    .card-front,
    .card-back {
      position: absolute; /* åŒã˜ä½ç½®ã«é‡ã­ã¦ç½®ã */
      width: 100%;
      height: 100%;
      border-radius: 10px;
      display: flex;
      align-items: center;     /* ç¸¦ï¼šä¸­å¤® */
      justify-content: center; /* æ¨ªï¼šä¸­å¤® */
      font-size: 28px;
      font-weight: bold;
      /* backface-visibilityï¼šè£è¿”ã£ãŸã¨ãã«éè¡¨ç¤ºã«ã™ã‚‹ */
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden; /* Safariç”¨ */
    }

    /* â”€â”€ ã‚«ãƒ¼ãƒ‰ã®è£é¢ï¼ˆæœ€åˆã«è¦‹ãˆã‚‹é¢ï¼‰â”€â”€ */
    .card-back {
      background-color: #5b8cde;
      color: white;
      font-size: 22px;
    }

    /* â”€â”€ ã‚«ãƒ¼ãƒ‰ã®è¡¨é¢ï¼ˆã‚ãã£ãŸå¾Œã«è¦‹ãˆã‚‹é¢ï¼‰â”€â”€ */
    .card-front {
      background-color: #ffffff;
      color: #2d3748;
      border: 2px solid #e2e8f0;
      /* è¡¨é¢ã¯æœ€åˆã‹ã‚‰180åº¦å›è»¢ã•ã›ã¦ãŠã */
      transform: rotateY(180deg);
    }

    /* â”€â”€ ãƒãƒƒãƒã—ãŸã‚«ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« â”€â”€ */
    .card.matched .card-front {
      background-color: #6bcb77;
      color: white;
      border-color: #6bcb77;
    }

    /* â”€â”€ ãƒãƒƒãƒã—ãŸã‚«ãƒ¼ãƒ‰ã¯ã‚¯ãƒªãƒƒã‚¯ã§ããªã„ â”€â”€ */
    .card.matched {
      cursor: default;
      pointer-events: none; /* ã‚¯ãƒªãƒƒã‚¯ã‚’ç„¡åŠ¹åŒ– */
    }

    /* â”€â”€ ãƒ•ãƒ«ãƒ¼ãƒ„çµµæ–‡å­—ã‚’å¤§ããè¡¨ç¤º â”€â”€ */
    /* card-front ã ã‘ font-size ã‚’ä¸Šæ›¸ãã™ã‚‹ */
    .card-front {
      font-size: 40px;
    }

    /* â”€â”€ ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ â”€â”€ */
    #reset-btn {
      background-color: #ff9800;
      color: white;
      border: none;          /* æ ç·šãªã— */
      border-radius: 8px;
      padding: 12px 32px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      /* ãƒœã‚¿ãƒ³ã«ãƒ›ãƒãƒ¼ï¼ˆä¹—ã›ã‚‹ï¼‰ã—ãŸã¨ãç”¨ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
      transition: background-color 0.2s, transform 0.1s;
    }

    /* ãƒã‚¦ã‚¹ã‚’ä¹—ã›ãŸã¨ã */
    #reset-btn:hover {
      background-color: #e68900;
      transform: translateY(-2px); /* å°‘ã—æµ®ãä¸ŠãŒã‚‹ */
    }

    /* ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ã */
    #reset-btn:active {
      transform: translateY(0); /* å…ƒã®ä½ç½®ã«æˆ»ã‚‹ */
    }

    /* â”€â”€ ã‚¯ãƒªã‚¢æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆæ™®æ®µã¯éè¡¨ç¤ºï¼‰â”€â”€ */
    #clear-message {
      display: none; /* æœ€åˆã¯éš ã™ */
      font-size: 20px;
      font-weight: bold;
      color: #e53935;
      margin-bottom: 16px;
      animation: pop 0.4s ease; /* è¡¨ç¤ºæ™‚ã«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    }

    /* â”€â”€ ãƒãƒƒãƒ—ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ‹¡å¤§â†’ç¸®å°ï¼‰â”€â”€ */
    @keyframes pop {
      0%   { transform: scale(0.5); opacity: 0; }
      70%  { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1);   opacity: 1; }
    }

    /* â”€â”€ ãƒã‚ºãƒ¬ã®ã¨ãã®ã‚·ã‚§ã‚¤ã‚¯ï¼ˆã¶ã‚‹ã¶ã‚‹ï¼‰â”€â”€ */
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      20%     { transform: translateX(-6px); }
      40%     { transform: translateX(6px); }
      60%     { transform: translateX(-4px); }
      80%     { transform: translateX(4px); }
    }
    /* .shake ã‚¯ãƒ©ã‚¹ãŒã¤ã„ãŸã‚«ãƒ¼ãƒ‰ãŒã¶ã‚‹ã¶ã‚‹éœ‡ãˆã‚‹ */
    .card.shake {
      animation: shake 0.5s ease;
    }

    /* â”€â”€ ãƒãƒƒãƒã®ã¨ãã®ãƒã‚¦ãƒ³ã‚¹ï¼ˆã´ã‚‡ã‚“ï¼ï¼‰â”€â”€ */
    @keyframes bounce-match {
      0%   { transform: scale(1); }
      35%  { transform: scale(1.22); }
      60%  { transform: scale(0.92); }
      80%  { transform: scale(1.07); }
      100% { transform: scale(1); }
    }
    /* .bounce ã‚¯ãƒ©ã‚¹ãŒã¤ã„ãŸã‚«ãƒ¼ãƒ‰ãŒã´ã‚‡ã‚“ã¨ã¯ã­ã‚‹ */
    .card.bounce {
      animation: bounce-match 0.45s ease;
    }

  </style>
</head>

<body>

  <!-- ========================================================
    HTMLï¼šç”»é¢ã®ãƒ‘ãƒ¼ãƒ„ã‚’æ›¸ãã¨ã“ã‚
  ======================================================== -->

  <!-- ã‚²ãƒ¼ãƒ å…¨ä½“ã‚’åŒ…ã‚€ç®± -->
  <div class="game-container">

    <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
    <h1>ğŸƒ ç¥çµŒè¡°å¼±ã‚²ãƒ¼ãƒ </h1>

    <!-- ã‚¹ã‚³ã‚¢è¡¨ç¤ºï¼ˆJavaScript ã§æ›¸ãæ›ãˆã‚‹ï¼‰ -->
    <p id="score">ãƒãƒƒãƒ: 0 / 8 çµ„</p>

    <!-- ã‚«ãƒ¼ãƒ‰ã‚’ä¸¦ã¹ã‚‹ã‚°ãƒªãƒƒãƒ‰ï¼ˆJavaScript ã§ã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ï¼‰ -->
    <div id="card-grid"></div>

    <!-- ã‚¯ãƒªã‚¢æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆæœ€åˆã¯ hiddenï¼‰ -->
    <p id="clear-message">ğŸ‰ å…¨éƒ¨ãƒãƒƒãƒï¼ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢ï¼</p>

    <!-- ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ -->
    <button id="reset-btn">ã‚‚ã†ä¸€åº¦ã‚ãã¶</button>

  </div>


  <!-- ========================================================
    JavaScriptï¼ˆã‚¸ãƒ£ãƒã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰ï¼šå‹•ãã‚’ä½œã‚‹ã¨ã“ã‚
    script ã‚¿ã‚°ã®ä¸­ã«æ›¸ãã¾ã™
  ======================================================== -->
  <script>

    // ============================================================
    // å¤‰æ•°ã®æº–å‚™ï¼ˆã‚²ãƒ¼ãƒ ã§ä½¿ã†ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹ç®±ï¼‰
    // ============================================================

    let cardValues   = [];   // å„ã‚«ãƒ¼ãƒ‰ã®ãƒ•ãƒ«ãƒ¼ãƒ„çµµæ–‡å­—ï¼ˆ16å€‹ï¼‰
    let flipped      = [];   // ä»Šã‚ãã£ã¦ã„ã‚‹ã‚«ãƒ¼ãƒ‰ã®è¦ç´ ï¼ˆæœ€å¤§2æšï¼‰
    let matchedCount = 0;    // ãƒãƒƒãƒã—ãŸçµ„ã®æ•°
    let canClick     = true; // ã‚¯ãƒªãƒƒã‚¯ã§ãã‚‹ã‹ã©ã†ã‹

    // â”€â”€ ãƒ•ãƒ«ãƒ¼ãƒ„çµµæ–‡å­—ã®ä¸€è¦§ â”€â”€
    // 8ç¨®é¡ã®ãƒ•ãƒ«ãƒ¼ãƒ„ã‚’ç”¨æ„ï¼ˆ2æšãšã¤ä½¿ã†ï¼‰
    const FRUITS = ["ğŸ", "ğŸŠ", "ğŸ‹", "ğŸ‡", "ğŸ“", "ğŸ‘", "ğŸ’", "ğŸ‰"];

    // â”€â”€ ãƒ•ãƒ«ãƒ¼ãƒ„ã”ã¨ã®èƒŒæ™¯è‰²ãƒãƒƒãƒ— â”€â”€
    // ãƒ•ãƒ«ãƒ¼ãƒ„ã®çµµæ–‡å­—ã‚’ã‚­ãƒ¼ã«ã—ã¦ã€è‰²ã‚’å–ã‚Šå‡ºã›ã‚‹
    const FRUIT_COLORS = {
      "ğŸ": "#FF8A80",  // ã‚Šã‚“ã”  â†’ èµ¤
      "ğŸŠ": "#FFAB40",  // ã¿ã‹ã‚“  â†’ ã‚ªãƒ¬ãƒ³ã‚¸
      "ğŸ‹": "#FFD740",  // ãƒ¬ãƒ¢ãƒ³  â†’ é»„è‰²
      "ğŸ‡": "#CE93D8",  // ã¶ã©ã†  â†’ ç´«
      "ğŸ“": "#F48FB1",  // ã„ã¡ã”  â†’ ãƒ”ãƒ³ã‚¯
      "ğŸ‘": "#FFCC80",  // ã‚‚ã‚‚    â†’ ã‚‚ã‚‚ã„ã‚
      "ğŸ’": "#EF9A9A",  // ã•ãã‚‰ã‚“ã¼ â†’ ã†ã™ã„èµ¤
      "ğŸ‰": "#A5D6A7",  // ã™ã„ã‹  â†’ ç·‘
    };


    // ============================================================
    // ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–ï¼ˆæœ€åˆã®çŠ¶æ…‹ã‚’ä½œã‚‹ï¼‰ã™ã‚‹é–¢æ•°
    // ============================================================

    function initGame() {

      // â”€â”€ å¤‰æ•°ã‚’ãƒªã‚»ãƒƒãƒˆ â”€â”€
      flipped      = [];
      matchedCount = 0;
      canClick     = true;

      // â”€â”€ ã‚«ãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œã‚‹ â”€â”€
      // FRUITS ã®8ç¨®é¡ã‚’2æšãšã¤ â†’ åˆè¨ˆ16æšã®é…åˆ—ã‚’ä½œã‚‹
      // [...FRUITS, ...FRUITS] ã¯ FRUITS ã‚’2ã¤ä¸¦ã¹ã‚‹æ›¸ãæ–¹
      const fruits = [...FRUITS, ...FRUITS];

      // Fisher-Yatesï¼ˆãƒ•ã‚£ãƒƒã‚·ãƒ£ãƒ¼ã‚¤ã‚§ãƒ¼ãƒ„ï¼‰ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
      // é…åˆ—ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã¹æ›¿ãˆã‚‹å®šç•ªã®æ–¹æ³•
      for (let i = fruits.length - 1; i > 0; i--) {
        // 0 ã€œ i ã®é–“ã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ•´æ•°ã‚’é¸ã¶
        const j = Math.floor(Math.random() * (i + 1));
        // fruits[i] ã¨ fruits[j] ã‚’å…¥ã‚Œæ›¿ãˆã‚‹
        [fruits[i], fruits[j]] = [fruits[j], fruits[i]];
      }

      cardValues = fruits; // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ä¿å­˜

      // â”€â”€ HTMLã«ã‚«ãƒ¼ãƒ‰ã‚’ä½œã‚‹ â”€â”€
      const grid = document.getElementById("card-grid");
      grid.innerHTML = ""; // å‰ã®ã‚«ãƒ¼ãƒ‰ã‚’æ¶ˆã™

      // 16æšåˆ†ã®ã‚«ãƒ¼ãƒ‰ã‚’ä½œã£ã¦ã‚°ãƒªãƒƒãƒ‰ã«è¿½åŠ ã™ã‚‹
      for (let i = 0; i < 16; i++) {
        const card = createCard(i, fruits[i]);
        grid.appendChild(card); // ã‚°ãƒªãƒƒãƒ‰ã«è¿½åŠ 
      }

      // â”€â”€ ã‚¹ã‚³ã‚¢ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆ â”€â”€
      updateScore();
      document.getElementById("clear-message").style.display = "none";
    }


    // ============================================================
    // ã‚«ãƒ¼ãƒ‰1æšã‚’ä½œã£ã¦è¿”ã™é–¢æ•°
    // i     = ã‚«ãƒ¼ãƒ‰ã®ç•ªå·ï¼ˆ0ã€œ15ï¼‰
    // value = ãƒ•ãƒ«ãƒ¼ãƒ„ã®çµµæ–‡å­—ï¼ˆä¾‹ï¼š"ğŸ"ï¼‰
    // ============================================================

    function createCard(i, value) {

      // â”€â”€ ã‚«ãƒ¼ãƒ‰ã®å¤–å´ã® div ã‚’ä½œã‚‹ â”€â”€
      const card = document.createElement("div");
      card.classList.add("card");        // CSS ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
      card.dataset.index = i;            // ã‚«ãƒ¼ãƒ‰ã®ç•ªå·ã‚’è¨˜æ†¶ã•ã›ã‚‹
      card.dataset.value = value;        // ãƒ•ãƒ«ãƒ¼ãƒ„çµµæ–‡å­—ã‚’è¨˜æ†¶ã•ã›ã‚‹

      // â”€â”€ å›è»¢ã™ã‚‹å†…å´ã® div â”€â”€
      const inner = document.createElement("div");
      inner.classList.add("card-inner");

      // â”€â”€ è£é¢ï¼ˆæœ€åˆã«è¦‹ãˆã‚‹é¢ï¼‰â”€â”€
      const back = document.createElement("div");
      back.classList.add("card-back");
      back.textContent = "?";            // è£é¢ã«ã¯ã€Œ?ã€ã‚’è¡¨ç¤º

      // â”€â”€ è¡¨é¢ï¼ˆã‚ãã£ãŸå¾Œã«è¦‹ãˆã‚‹é¢ï¼‰â”€â”€
      const front = document.createElement("div");
      front.classList.add("card-front");
      front.textContent = value;         // è¡¨é¢ã«ã¯ãƒ•ãƒ«ãƒ¼ãƒ„çµµæ–‡å­—ã‚’è¡¨ç¤º

      // ãƒ•ãƒ«ãƒ¼ãƒ„ã”ã¨ã®èƒŒæ™¯è‰²ã‚’è¨­å®šã™ã‚‹
      // FRUIT_COLORS ã‹ã‚‰çµµæ–‡å­—ã‚’ã‚­ãƒ¼ã«è‰²ã‚’å–ã‚Šå‡ºã™
      front.style.backgroundColor = FRUIT_COLORS[value];
      front.style.border = "none"; // è‰²ã§åŒºåˆ¥ã§ãã‚‹ã®ã§æ ç·šã¯æ¶ˆã™

      // â”€â”€ çµ„ã¿ç«‹ã¦ã‚‹ï¼ˆå…¥ã‚Œå­ã«ã™ã‚‹ï¼‰â”€â”€
      // inner ã®ä¸­ã« back ã¨ front ã‚’å…¥ã‚Œã‚‹
      inner.appendChild(back);
      inner.appendChild(front);
      // card ã®ä¸­ã« inner ã‚’å…¥ã‚Œã‚‹
      card.appendChild(inner);

      // â”€â”€ ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã®å‡¦ç†ã‚’ç™»éŒ² â”€â”€
      card.addEventListener("click", function() {
        onCardClick(card);
      });

      return card; // ä½œã£ãŸã‚«ãƒ¼ãƒ‰ã‚’è¿”ã™
    }


    // ============================================================
    // ã‚«ãƒ¼ãƒ‰ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å‡¦ç†
    // ============================================================

    function onCardClick(card) {

      // ã‚¯ãƒªãƒƒã‚¯ä¸å¯ã®ã¨ãï¼ˆåˆ¤å®šä¸­ï¼‰ã¯ä½•ã‚‚ã—ãªã„
      if (!canClick) return;

      // ã™ã§ã«ã‚ãã‚‰ã‚Œã¦ã„ã‚‹ã‚«ãƒ¼ãƒ‰ã¯ç„¡è¦–
      if (card.classList.contains("flipped")) return;
      if (card.classList.contains("matched")) return;

      // â”€â”€ ã‚«ãƒ¼ãƒ‰ã‚’ã‚ãã‚‹ â”€â”€
      // "flipped" ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã¨ CSS ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ã
      card.classList.add("flipped");
      flipped.push(card); // ã‚ãã£ãŸã‚«ãƒ¼ãƒ‰ã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ 

      // 2æšã‚ãã£ãŸã‚‰åˆ¤å®šã™ã‚‹
      if (flipped.length === 2) {
        checkMatch();
      }
    }


    // ============================================================
    // 2æšã®ã‚«ãƒ¼ãƒ‰ãŒåŒã˜ã‹ã©ã†ã‹åˆ¤å®šã™ã‚‹é–¢æ•°
    // ============================================================

    function checkMatch() {

      const card1 = flipped[0]; // 1æšç›®ã®ã‚«ãƒ¼ãƒ‰è¦ç´ 
      const card2 = flipped[1]; // 2æšç›®ã®ã‚«ãƒ¼ãƒ‰è¦ç´ 

      // dataset.value ã§ã‚«ãƒ¼ãƒ‰ã®æ•°å­—ã‚’å–ã‚Šå‡ºã™
      const val1 = card1.dataset.value;
      const val2 = card2.dataset.value;

      if (val1 === val2) {
        // â”€â”€ ãƒãƒƒãƒæˆåŠŸï¼ â”€â”€

        // ãƒã‚¦ãƒ³ã‚¹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç™ºç«ï¼ˆã´ã‚‡ã‚“ï¼ï¼‰
        card1.classList.add("bounce");
        card2.classList.add("bounce");
        // 450ms å¾Œã«ã‚¯ãƒ©ã‚¹ã‚’å¤–ã™ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰
        setTimeout(() => {
          card1.classList.remove("bounce");
          card2.classList.remove("bounce");
        }, 450);

        // "matched" ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ï¼ˆç·‘è‰²ã«ãªã‚‹ï¼‰
        card1.classList.add("matched");
        card2.classList.add("matched");

        matchedCount++; // ãƒãƒƒãƒæ•°ã‚’1å¢—ã‚„ã™
        flipped = [];   // ã‚ãã‚Šãƒªã‚¹ãƒˆã‚’ç©ºã«ã™ã‚‹

        updateScore(); // ã‚¹ã‚³ã‚¢ã‚’æ›´æ–°

        // å…¨éƒ¨ï¼ˆ8çµ„ï¼‰ãƒãƒƒãƒã—ãŸã‚‰ã‚¯ãƒªã‚¢ï¼
        if (matchedCount === 8) {
          showClear();
        }

      } else {
        // â”€â”€ ãƒãƒƒãƒå¤±æ•— â”€â”€

        canClick = false; // å¾…ã£ã¦ã„ã‚‹é–“ã¯ã‚¯ãƒªãƒƒã‚¯ç¦æ­¢

        // ã‚·ã‚§ã‚¤ã‚¯ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç™ºç«ï¼ˆã¶ã‚‹ã¶ã‚‹ï¼ï¼‰
        card1.classList.add("shake");
        card2.classList.add("shake");

        // setTimeoutï¼šã€‡ãƒŸãƒªç§’å¾Œã«é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹
        // 1000 = 1ç§’å¾Œã« flipBack ã‚’å‘¼ã¶
        setTimeout(flipBack, 1000);
      }
    }


    // ============================================================
    // ãƒãƒƒãƒã—ãªã‹ã£ãŸã‚«ãƒ¼ãƒ‰ã‚’è£ã«æˆ»ã™é–¢æ•°
    // ============================================================

    function flipBack() {

      // "flipped" ã¨ "shake" ã‚¯ãƒ©ã‚¹ã‚’å¤–ã™ â†’ è£ã«æˆ»ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ã
      flipped[0].classList.remove("flipped", "shake");
      flipped[1].classList.remove("flipped", "shake");

      flipped   = [];   // ã‚ãã‚Šãƒªã‚¹ãƒˆã‚’ç©ºã«ã™ã‚‹
      canClick  = true; // ã¾ãŸã‚¯ãƒªãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
    }


    // ============================================================
    // ã‚¹ã‚³ã‚¢ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
    // ============================================================

    function updateScore() {
      const scoreEl = document.getElementById("score");
      scoreEl.textContent = `ãƒãƒƒãƒ: ${matchedCount} / 8 çµ„`;
    }


    // ============================================================
    // ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢æ™‚ã®è¡¨ç¤º
    // ============================================================

    function showClear() {
      const msg = document.getElementById("clear-message");
      msg.style.display = "block"; // éš ã—ã¦ã„ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹
    }


    // ============================================================
    // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã«ã‚¯ãƒªãƒƒã‚¯å‡¦ç†ã‚’ç™»éŒ²
    // ============================================================

    const resetBtn = document.getElementById("reset-btn");
    resetBtn.addEventListener("click", function() {
      initGame(); // ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–ã—ç›´ã™
    });


    // ============================================================
    // ãƒšãƒ¼ã‚¸ãŒé–‹ã„ãŸã¨ãã€æœ€åˆã«ã‚²ãƒ¼ãƒ ã‚’èµ·å‹•ã™ã‚‹
    // ============================================================

    initGame();

  </script>

</body>
</html>

